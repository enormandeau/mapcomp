#!/bin/bash

# Indexing genome
# bwa index 02_data/genome/genome.fasta

# Running MapComp
echo "Running MapComp"

# Mapping reads
./01_scripts/01_bwa_align_reads.sh

# Identify good loci
./01_scripts/02_filter_bad_loci.sh \
    03_mapped/markers.fasta.sorted.bam

# Extracting good loci
./01_scripts/03_extract_good_loci.py \
    03_mapped/markers.fasta.sam \
    03_mapped/wanted_loci.ids 03_mapped/wanted_loci.sam

# Extracting best marker pairs
./01_scripts/04_pair_markers.py \
    03_mapped/wanted_loci.sam \
    03_mapped/wanted_loci.ids \
    03_mapped/wanted_loci.info \
    10000000

# Creating figures
R --slave -e 'source("01_scripts/05_create_figures.R")'
